<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Universal</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h2>Universal</h2>

<pre><code class="r">echo = TRUE
set.seed(1)
</code></pre>

<h2>Report Content</h2>

<p>This is the report for the Machine Learning Project posted on Practical Machine Learning module of the Data Science Specialisation offered by The Johns Hopkins Univeristy through Coursera.</p>

<h2>Synopsis</h2>

<p>Using devices such as Jawbone Up, Nike FuelBand, and Fitbit it is now possible to collect a large amount of data about personal activity relatively inexpensively. In this project, the  data comes from accelerometers on the belt, forearm, arm, and dumbell of 6 participants. They were asked to perform barbell lifts correctly and incorrectly in 5 different ways.</p>

<p>The goal of the project is to predict the manner in which they did the exercise. This is the &ldquo;classe&rdquo; variable in the training set. </p>

<h2>Data</h2>

<p>The data for this assignment was downloaded from the course web
site:</p>

<ul>
<li>Training Dataset: <a href="https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv">https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv</a></li>
<li>Testing Dataset: <a href="https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv">https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv</a></li>
</ul>

<h2>Loading and preprocessing the data</h2>

<p>dplyr package is used to organise the data while caret is used for pre processing and randomForest for building a classification model </p>

<pre><code class="r">echo = FALSE
library(dplyr)
</code></pre>

<pre><code>## 
## Attaching package: &#39;dplyr&#39;
## 
## The following object is masked from &#39;package:stats&#39;:
## 
##     filter
## 
## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union
</code></pre>

<pre><code class="r">library(caret)
</code></pre>

<pre><code>## Warning: package &#39;caret&#39; was built under R version 3.1.3
</code></pre>

<pre><code>## Loading required package: lattice
## Loading required package: ggplot2
</code></pre>

<pre><code class="r">library(rattle)
</code></pre>

<pre><code>## Warning: package &#39;rattle&#39; was built under R version 3.1.3
</code></pre>

<pre><code>## Rattle: A free graphical interface for data mining with R.
## Version 3.4.1 Copyright (c) 2006-2014 Togaware Pty Ltd.
## Type &#39;rattle()&#39; to shake, rattle, and roll your data.
</code></pre>

<pre><code class="r">library(rpart)
</code></pre>

<pre><code>## Warning: package &#39;rpart&#39; was built under R version 3.1.3
</code></pre>

<pre><code class="r">train &lt;- read.csv(&quot;pml-training.csv&quot;,stringsAsFactors = FALSE,na.strings=c(&quot;&quot;,&quot;NA&quot;,&quot;#DIV/0!&quot;))
test &lt;- read.csv(&quot;pml-testing.csv&quot;,stringsAsFactors = FALSE)
</code></pre>

<h2>What is the distribution of the &ldquo;classe&rdquo; variable?</h2>

<p>The distribtion of the classe variable in the training set will help one understand the spread and scope of the problem</p>

<pre><code class="r">l &lt;- as.data.frame(table(train$classe))
plot1 &lt;- ggplot(l,aes(x=l[,1],y = l[,2]))+geom_bar(stat = &quot;identity&quot;,fill = &quot;light blue&quot;)
plot1 &lt;- plot1+xlab(&quot;classe variable&quot;)+ylab(&quot;Frequency&quot;)
plot1 + theme_classic()+ggtitle(&quot;Distribution of &#39;classe&#39; variable&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAllBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6AGY6OmY6OpA6ZrY6kNtmAABmADpmAGZmOgBmOpBmZmZmkJBmtv+QOgCQOjqQOmaQZpCQkGaQtpCQ27aQ2/+t2Oa2ZgC2Zjq225C22/+2/7a2/9u2///bkDrbtmbb25Db29vb/7bb/9vb////tmb/25D/27b//7b//9v///9pYOcNAAAACXBIWXMAAAsSAAALEgHS3X78AAANeElEQVR4nO2dDXvayBlFZdd4Uxcnmy3Otiml29a03RoK+v9/rhp9APY6kRyE5r255zwO2KC5XDhoJAGxixIsKXIXgDwg3hTEm4J4UxBvCuJNQbwpiDcF8aYg3hTEm4J4UxBvCuJNQbwpiDcF8aZ8J+L/843X+SInfv9QVFwty3L3fnm4bN58U120u1+8WH5+suTrbIoiBWzfPZaHnK+3OC76G07Gdl164zIgKD49mJti8eyy+eH718T3sZrVZ+OIPwHxI9KIL9c3T+nhXKeVP00Cs/2nPxdXf0lr/B9vi+vH5kHfXP8zXZeWTAvdPFUOPt/W80WTVV+2KtKAxub2tllqmb4r0tNr3cwv7Vk7pBVfP2Oqk3bZrkP386HL8fbDoCp++8Oyejg31aNa/Utr9f6hEba7ry5bXz+24h/bqX7/UDlaVc+WdPWqMdBd1q3xu4/V1Yt2QD1+df3Y3sTJLdVPuo91wqZ5hnXLHjs0Px+6pNtvBmZ73F6iKj493I34spnO60e2e9A7GUfx9Sp6cnEa1l3WiS8P13Rzc2v8eEV91lZoWnTXHJ4WJ2MPXdqmx4H50Raf5s9FJ37RiH9fT8jzF+I3aWU7uThldJediG/XyTpkd582AYeb6Ob9xGG3oRpZD+6WXTwbe+jyfvlyYHZUxTdTffXNqt7Ijy++UjdvF1w1OwXp7OVkvbn+x33aljfLHjq0P5+KDzTL16iKb3fu6gvmz8SPNNXXz4qTTUlz1s3rHdXuWxXSLdt16H5+OdVHQlR8OpxrH85q3X8uvtl7S3tu+4dXdu4WJz6f79yVzdNgPTtE3151N3G4pWrxzdXx6GxdzJq8tOxBfPtz16W+/RcDcyMo/vQFnFV3yDU7TvWf6yOyNP9efa5Wx/Xzw7kT8YdDrKP4dCDWHn+lg7w0j7c30Z6lIaf6trfpedgue9jGtz93XbrbD+RdTzyMA+JNQbwp3yqeJ4w4iDcF8aYg3hTEm4J4UxBvCuJNQbwpiDcF8aYg3hTEm4J4UxBvCuJNQbwpiDcF8aYg3pRRxP91PEa4SzAExJuCeFMQbwriTUG8KYg3BfGmIN4UxJuCeFMQbwriTUG8KYg3BfGmIN4UxJuCeFMQbwriTUG8KYg3BfGmIN4UxJuCeFMQbwriTUG8KYg3BfGmIN4UxJuCeFMQbwriTUG8KYg3BfGmIN4UxJuCeFMQbwriTUG8KYg3BfGmIN4UxJuCeFMQbwriTUG8KYg3BfGmIN4UxJuCeFMQbwriTUG8KYg3BfGmIN4UxJuCeFMQbwriTUG8KYg3BfGmIN4UxJuCeFMQbwriTUG8KYg3BfGmIN4UxJuCeFMQbwriTUG8KYg3BfGmIN4UxJuCeFMQbwriTUG8KYg3BfGmIN4UxJuCeFMQbwriTUG8KYg3BfGmIN4UxJuCeFMQbwriTfma+PW8LFfF1fL56SvjEK/HV8Rvinm5uXl68fXaOMTr8WXx27t/zdNKv/vweHqaxiROF0W8Hl8UXzneVOIX5f7nx9PT18YhXo8vil+n1Xr+6hr/m3GI1+NrO3cbtvHfLz3i2av/XuE43hTEm4J4UxBvCuJNQbwpiDcF8aYg3pSo4i8QCacg3hTEm4J4UxBvCuJNQbwpiDcF8aYg3hTEm4J4UxBvCuJNQXw0RrznX7vriI/GiPcc8UqMeM8Rr8SI9xzxSox4zxGvxIj3HPFKjHjPEa/EiPcc8UqMeM8Rr8SI9xzxSox4zxGvxIj3HPFKjHjPET/lI3ouE9VE/FmZF2Cimog/K/MCTFQT8WdlXoCJaiL+rMwLMFFNxJ+VeQEmqon4szIvwEQ1EX9W5gWYqCbiz8q8ABPVRPxZmRdgopqIPyvzAkxUE/FnZV6AiWoi/qzMCzBRTcSflXkBJqqJ+CiZiBeIVKvZK353P0N8psys4tPfFT35U1OInzAzs/iK/UNRLBA/dWZm8dvbtMYf/6Ik4qfKzCp+d3/4U5KInzgzq/jhIF6pZr/4TbV1Xw/Zu0O8Us1e8bv3yfn2Xd8WHvFaNXvF7x/S7vxmwIYe8Uo1e8VXe3dFUVz3r/CIl6rZL34wiFeqifjAmXnFb4pi2FyPeKWaveJ3972v1SL+Qpl5xfe+VIv4S2VmFV+u5ojPlJlVfH00xzY+S2ZW8cNBvFJNxAfOzCt+/1Dc/PqeN2kyZGYVv3+Yb++eeK0+R2ZW8dXhXCV+yEEd4pVq9opv1vg1a3yGzKzi6w9aFkM+foV4pZr94geDeKWaiA+cmVU8r9zly8wqvmE94AV7xCvVHCiew7kcmQHEb5jqM2RmFd9u4wd8GgPxSjV7xQ8H8Uo1ER84M6v4dqofcECHeKWaveLL9aw7QfzEmVnFNwdyHM7lyMwqfv+QXrthjc+RmVV88+7ckF+AhHilmv3iB4N4pZqID5yZVzwftsyWmVU8H7bMl5lVPB+2zJeZVTwftsyXmVU8H7bMl5lX/GAQr1SzVzz/Pz5fZlbx+09DfnM14tVq9ornU7b5MrOKHw7ilWoiPnBmRvHDd+0Qr1VzgPjt3bBfWI94pZqID5yJeIFItZp94gd/xhbxWjX7BL4BxCvVRHzgTMQLRKrVRHzgTMQLRKrVRHzgTMQLRKrVRHzgTMQLRKrVRHzgTMQLRKrVRHzgTMQLRKrVRHzgTMQLRKrVRHzgTMQLRKrVRHzgTMQLRKrVRHzgTMQLRKrVRHzgTMQLRKrVRHzgTMQLRKrVRHzgzCji0++/unkqV8XVsnx2ivjLZEYRv5lVphebm6cXX4i/UGYU8Yn1Yj1P/4f29DSNSSBeqOYbxVcr/XpR7n9+PD19bdwFqsaOVKv5NvGrWf3XRn+7xiNereZbxO8f0p8dZBs/WWYU8au0IZ+zVz9ZZhTxPSBeqSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSrSbiA2ciXiBSreaZ4lfF1RLxl8qMK35z81R9If5CmXHFr+fl7sNjGpMYPg4i8hbxi3L/8+Pbx0FEvmWNf+M4iMgo23jQY5S9etBjlON40APxpiDeFMSbgnhTEG8K4k1BvCmINwXxpiDeFMSbgnhTEG8K4k35ZvEgxkjiv+GpopHpUhPxl48MWRPxl48MWZOdNFMQbwriTUG8KYg3ZSrx23eP/Qu9LfG2KIr5+JkXiCwW40eemzmV+NVPIz+g5fbuqdx/WvYvOJzd+2W5fxjZ0h+a3DEj7576F+pjIvG7j79+GHmVr8X/aYSH4Mh67Cdn2YgfOVhJ/HqRvkalnvCuR302jV0xUYvfjCt+jHs+jfjdfVX1ZtS1s3ner0ZVVfv539/HjGzX+FFrCq3xm1k5tqRLiG+28ePO9/U2ftzNnI74Zh9sM+4qX094szETtfbqz+zJcbwpiDcF8aYg3hTEm2Il/u1vGJyMaI4cx3/PIROIHwriJdndF1fLZC0dBFcKN82Lnu1ZdW39Emj7xk+zzPb3P17/chyx+qm+sLqgW1oaE/HpPbfNzb/fPaYX5yp56bW09axsz8rVvD6rX2na3v3aLLO9rT23I8rVzVO6MH3XLi2Nifhmhm7n6Up3+0bpyVnzsup63r6TVv1Yzw+HEfVUv1q0z4SRX4TNgIv4+uXtWuOqnt2r+Tv9ms7mrH4Pqf6tndu7/6aXl+tlDuKbEX9bduIPSyvjIr5b43f3i241bt87qM6O6+/+0+e7p3aZVnw3olrjqw1Gu5nQx0R82sZv3/3S2vxhmaS3v5Q5/au22u3TYF3My3aZVnz7U7malcdt/MhvOGXARPxxr35dFL/7cdFO391ZfW29XFLcLtNN9d2In9Iy7V69/ExvIx5egHhTEG8K4k1BvCmINwXxpiDeFMSbgnhT/g+bK7qW1rXf3QAAAABJRU5ErkJggg==" alt="plot of chunk unnamed-chunk-3"/> </p>

<h2>Data cleansing and engineering</h2>

<p>After understanding the spread, I went on cleaning the data. </p>

<ul>
<li>The time variable is cleaned and the day and hour variables are extracted from it</li>
<li>Certain variables which had a very high proportion of NA&#39;s - User name, time stamp etc were turned off</li>
<li>Prinicpal Component Analysis was performed to identify the variables that explain 95% of the variability</li>
<li>All this was done after combining the training and testing set</li>
</ul>

<p>Note that the feature engieering (dropping variables which were significantly &ldquo;NAs&rdquo; and PCA) resulted in the number of predictor variables dropping to 26 from 159</p>

<pre><code class="r">data &lt;- rbind(train[,-160],test[,-160])

m &lt;- c()
for (i in 1:159) { ifelse(sum(is.na(data[,i])),1,m &lt;- c(m,i))}
t &lt;- data[,m]

t$time &lt;- strptime(t$cvtd_timestamp,&quot;%d/%m/%Y %H:%M&quot;)
t$hour &lt;- t$time$hour
t$day &lt;- t$time$wday

t$X = NULL
t$user_name = NULL
t$raw_timestamp_part_1 = NULL
t$raw_timestamp_part_2 = NULL
t$cvtd_timestamp  = NULL
t$time  = NULL
t$new_window = NULL

y &lt;- preProcess(t[2:54],method = &quot;pca&quot;)
tr &lt;- predict(y,t[2:54])
tr$classe &lt;- t$classe
tr$hour &lt;- t$hour
tr$day &lt;- t$day
</code></pre>

<p>After this the training and the testing set are seprated again</p>

<pre><code class="r">train1 &lt;- head(t,nrow(train))
train1$classe &lt;- train$classe
test &lt;- tail(t,nrow(test))
</code></pre>

<h2>Model Building</h2>

<p>Once the feature engineering is done, I proceeded with developing models to understand the importance of the different variables.</p>

<p>I decided to first build a CART model to understand how the variables interact with each other </p>

<pre><code class="r">mod &lt;- rpart(as.factor(classe)~.,data=train1,method=&quot;class&quot;)
fancyRpartPlot(mod)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-6"/> </p>

<p>After understanding the interaction, I decided to build a random forest model.
The reasons for choosing random forest model were:</p>

<ul>
<li>Good experience in the past in successfully applying RF for classification problems</li>
<li>More accurate than the CART model</li>
<li>Relatively faster</li>
</ul>

<h2>Cross Validation</h2>

<p>In order to validate the accuracy of the prediction, I decided to do a cross validation by paritioning the training set in to 2 sets.</p>

<p>This is done as follows</p>

<pre><code class="r">mod &lt;- createDataPartition(y=train1$classe, p=0.6, list=FALSE)
train_cv &lt;- train1[mod, ]; test_cv &lt;- train1[-mod, ]
dim(train_cv); dim(test_cv)
</code></pre>

<pre><code>## [1] 11776    56
</code></pre>

<pre><code>## [1] 7846   56
</code></pre>

<p>Proceeding with the random forest model, I have decided to use a 5 fold cross validation as under</p>

<pre><code class="r">controlRf &lt;- trainControl(method=&quot;cv&quot;, 5)
mod &lt;- train(as.factor(classe) ~ ., data=train_cv, method=&quot;rf&quot;, trControl=controlRf, ntree=250)
</code></pre>

<pre><code>## Loading required package: randomForest
</code></pre>

<pre><code>## Warning: package &#39;randomForest&#39; was built under R version 3.1.3
</code></pre>

<pre><code>## randomForest 4.6-10
## Type rfNews() to see new features/changes/bug fixes.
## 
## Attaching package: &#39;randomForest&#39;
## 
## The following object is masked from &#39;package:dplyr&#39;:
## 
##     combine
</code></pre>

<pre><code class="r">mod
</code></pre>

<pre><code>## Random Forest 
## 
## 11776 samples
##    55 predictor
##     5 classes: &#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39; 
## 
## No pre-processing
## Resampling: Cross-Validated (5 fold) 
## 
## Summary of sample sizes: 9420, 9421, 9421, 9420, 9422 
## 
## Resampling results across tuning parameters:
## 
##   mtry  Accuracy   Kappa      Accuracy SD  Kappa SD   
##    2    0.9911681  0.9888263  0.002277044  0.002883162
##   28    0.9955840  0.9944140  0.001147934  0.001452190
##   55    0.9918476  0.9896870  0.002235630  0.002828294
## 
## Accuracy was used to select the optimal model using  the largest value.
## The final value used for the model was mtry = 28.
</code></pre>

<pre><code class="r">pred &lt;- predict(mod, test_cv)
</code></pre>

<p>The accuracy and out of stock error is given by the confusion matrix</p>

<pre><code class="r">confusionMatrix(pred, test_cv$classe)
</code></pre>

<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 2232    4    0    0    0
##          B    0 1510    1    0    0
##          C    0    4 1359    5    0
##          D    0    0    8 1279    0
##          E    0    0    0    2 1442
## 
## Overall Statistics
##                                          
##                Accuracy : 0.9969         
##                  95% CI : (0.9955, 0.998)
##     No Information Rate : 0.2845         
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16      
##                                          
##                   Kappa : 0.9961         
##  Mcnemar&#39;s Test P-Value : NA             
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            1.0000   0.9947   0.9934   0.9946   1.0000
## Specificity            0.9993   0.9998   0.9986   0.9988   0.9997
## Pos Pred Value         0.9982   0.9993   0.9934   0.9938   0.9986
## Neg Pred Value         1.0000   0.9987   0.9986   0.9989   1.0000
## Prevalence             0.2845   0.1935   0.1744   0.1639   0.1838
## Detection Rate         0.2845   0.1925   0.1732   0.1630   0.1838
## Detection Prevalence   0.2850   0.1926   0.1744   0.1640   0.1840
## Balanced Accuracy      0.9996   0.9973   0.9960   0.9967   0.9998
</code></pre>

<h2>Output Generation</h2>

<p>As one can see, the model has a high level of accuracy(&gt; 99.7%) and very low out of sample error (&lt; 0.30%) and hence I decided to apply the same to the actual test case. Also the code snippet from the module to write the CSV files is added here as well</p>

<pre><code class="r">pred &lt;- predict(mod,newdata=test)

pml_write_files = function(x){
  n = length(x)
  for(i in 1:n){
    filename = paste0(&quot;problem_id_&quot;,i,&quot;.txt&quot;)
    write.table(x[i],file=filename,quote=FALSE,row.names=FALSE,col.names=FALSE)
  }
}

pml_write_files(pred)
</code></pre>

<h2>Conclusion</h2>

<p>The outputs generated in the previous step were submitted and the result was 100%. </p>

<p>As a quick summary, following were the steps taken to achieve the perfect score</p>

<ul>
<li>Clean and reengineer the data - remove NAs and extract the date and hour variables </li>
<li>Apply 5 fold CV to tune the random forest model</li>
<li>Observe the accuracy and the out of sample error</li>
<li>On satisfying oneself with the accuracy, proceed to apply the model to the test case.</li>
</ul>

</body>

</html>
